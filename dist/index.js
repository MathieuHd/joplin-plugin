(()=>{"use strict";var e={998:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.default=joplin},143:(e,t)=>{var o,n,i,a,r,l,c,u,s,d;Object.defineProperty(t,"__esModule",{value:!0}),t.ContentScriptType=t.SettingStorage=t.AppType=t.SettingItemSubType=t.SettingItemType=t.ToolbarButtonLocation=t.isContextMenuItemLocation=t.MenuItemLocation=t.ModelType=t.ImportModuleOutputFormat=t.FileSystemItem=void 0,(d=t.FileSystemItem||(t.FileSystemItem={})).File="file",d.Directory="directory",(s=t.ImportModuleOutputFormat||(t.ImportModuleOutputFormat={})).Markdown="md",s.Html="html",(u=t.ModelType||(t.ModelType={}))[u.Note=1]="Note",u[u.Folder=2]="Folder",u[u.Setting=3]="Setting",u[u.Resource=4]="Resource",u[u.Tag=5]="Tag",u[u.NoteTag=6]="NoteTag",u[u.Search=7]="Search",u[u.Alarm=8]="Alarm",u[u.MasterKey=9]="MasterKey",u[u.ItemChange=10]="ItemChange",u[u.NoteResource=11]="NoteResource",u[u.ResourceLocalState=12]="ResourceLocalState",u[u.Revision=13]="Revision",u[u.Migration=14]="Migration",u[u.SmartFilter=15]="SmartFilter",u[u.Command=16]="Command",function(e){e.File="file",e.Edit="edit",e.View="view",e.Note="note",e.Tools="tools",e.Help="help",e.Context="context",e.NoteListContextMenu="noteListContextMenu",e.EditorContextMenu="editorContextMenu",e.FolderContextMenu="folderContextMenu",e.TagContextMenu="tagContextMenu"}(o=t.MenuItemLocation||(t.MenuItemLocation={})),t.isContextMenuItemLocation=function(e){return[o.Context,o.NoteListContextMenu,o.EditorContextMenu,o.FolderContextMenu,o.TagContextMenu].includes(e)},(c=t.ToolbarButtonLocation||(t.ToolbarButtonLocation={})).NoteToolbar="noteToolbar",c.EditorToolbar="editorToolbar",(l=t.SettingItemType||(t.SettingItemType={}))[l.Int=1]="Int",l[l.String=2]="String",l[l.Bool=3]="Bool",l[l.Array=4]="Array",l[l.Object=5]="Object",l[l.Button=6]="Button",(r=t.SettingItemSubType||(t.SettingItemSubType={})).FilePathAndArgs="file_path_and_args",r.FilePath="file_path",r.DirectoryPath="directory_path",(a=t.AppType||(t.AppType={})).Desktop="desktop",a.Mobile="mobile",a.Cli="cli",(i=t.SettingStorage||(t.SettingStorage={}))[i.Database=1]="Database",i[i.File=2]="File",(n=t.ContentScriptType||(t.ContentScriptType={})).MarkdownItPlugin="markdownItPlugin",n.CodeMirrorPlugin="codeMirrorPlugin"},156:function(e,t,o){var n=this&&this.__awaiter||function(e,t,o,n){return new(o||(o=Promise))((function(i,a){function r(e){try{c(n.next(e))}catch(e){a(e)}}function l(e){try{c(n.throw(e))}catch(e){a(e)}}function c(e){var t;e.done?i(e.value):(t=e.value,t instanceof o?t:new o((function(e){e(t)}))).then(r,l)}c((n=n.apply(e,t||[])).next())}))};Object.defineProperty(t,"__esModule",{value:!0});const i=o(998),a=o(681);i.default.plugins.register({onStart:function(){return n(this,void 0,void 0,(function*(){a.noteVariables.init()}))}})},681:function(e,t,o){var n=this&&this.__awaiter||function(e,t,o,n){return new(o||(o=Promise))((function(i,a){function r(e){try{c(n.next(e))}catch(e){a(e)}}function l(e){try{c(n.throw(e))}catch(e){a(e)}}function c(e){var t;e.done?i(e.value):(t=e.value,t instanceof o?t:new o((function(e){e(t)}))).then(r,l)}c((n=n.apply(e,t||[])).next())}))};Object.defineProperty(t,"__esModule",{value:!0}),t.noteVariables=void 0;const i=o(998),a=o(143),r=o(527),l=o(946);!function(e){const t=e=>n(this,void 0,void 0,(function*(){2===e.event&&(0,l.loadVariablesNotes)()}));e.init=function(){return n(this,void 0,void 0,(function*(){yield i.default.contentScripts.register(a.ContentScriptType.MarkdownItPlugin,"noteVariablesMD","./markdownItPlugin.js"),yield i.default.workspace.onNoteChange(t),yield i.default.workspace.onNoteSelectionChange(l.loadVariablesNotes),yield i.default.commands.register({name:"newVariablesNote",label:"Create variables note",iconName:"fas fa-superscript",execute:()=>n(this,void 0,void 0,(function*(){const e=yield i.default.workspace.selectedFolder();(0,r.createVariablesNote)(e.id)}))}),yield i.default.views.menuItems.create("Create variables vote","newVariablesNote",a.MenuItemLocation.Note),yield(0,l.loadVariablesNotes)()}))}}(t.noteVariables||(t.noteVariables={}))},527:function(e,t,o){var n=this&&this.__awaiter||function(e,t,o,n){return new(o||(o=Promise))((function(i,a){function r(e){try{c(n.next(e))}catch(e){a(e)}}function l(e){try{c(n.throw(e))}catch(e){a(e)}}function c(e){var t;e.done?i(e.value):(t=e.value,t instanceof o?t:new o((function(e){e(t)}))).then(r,l)}c((n=n.apply(e,t||[])).next())}))};Object.defineProperty(t,"__esModule",{value:!0}),t.createVariablesNote=void 0;const i=o(998),a=o(971);t.createVariablesNote=e=>n(void 0,void 0,void 0,(function*(){const t=yield(0,a.fetchAllNotes)(),o=`%Variables${Math.max(0,...t.map((e=>{const t=e.title.match(/^%Variables([0-9]+)%$/);return null==t?0:parseInt(t[1])})))+1}%`;yield i.default.data.post(["notes"],null,{body:"| variable | value |\n| -------- | ----- |\n|          |       |\n",title:o,parent_id:e})}))},971:function(e,t,o){var n=this&&this.__awaiter||function(e,t,o,n){return new(o||(o=Promise))((function(i,a){function r(e){try{c(n.next(e))}catch(e){a(e)}}function l(e){try{c(n.throw(e))}catch(e){a(e)}}function c(e){var t;e.done?i(e.value):(t=e.value,t instanceof o?t:new o((function(e){e(t)}))).then(r,l)}c((n=n.apply(e,t||[])).next())}))};Object.defineProperty(t,"__esModule",{value:!0}),t.fetchAllNotes=void 0;const i=o(998);t.fetchAllNotes=()=>n(void 0,void 0,void 0,(function*(){const e=(yield i.default.data.get(["tags"])).items.filter((e=>"variablenote"==e.title))[0].id;console.info("TagId: "+e);const t=[];let o=1;for(;;){const e=yield i.default.data.get(["notes"],{page:o});if(t.push(...e.items),console.info("Found new items:"),console.info(JSON.stringify(e.items)),!e.has_more)return t;o++}}))},437:function(e,t,o){var n=this&&this.__awaiter||function(e,t,o,n){return new(o||(o=Promise))((function(i,a){function r(e){try{c(n.next(e))}catch(e){a(e)}}function l(e){try{c(n.throw(e))}catch(e){a(e)}}function c(e){var t;e.done?i(e.value):(t=e.value,t instanceof o?t:new o((function(e){e(t)}))).then(r,l)}c((n=n.apply(e,t||[])).next())}))};Object.defineProperty(t,"__esModule",{value:!0}),t.findVariablesNotes=void 0;const i=o(971);t.findVariablesNotes=()=>n(void 0,void 0,void 0,(function*(){return yield(0,i.fetchAllNotes)()}))},946:function(e,t,o){var n=this&&this.__awaiter||function(e,t,o,n){return new(o||(o=Promise))((function(i,a){function r(e){try{c(n.next(e))}catch(e){a(e)}}function l(e){try{c(n.throw(e))}catch(e){a(e)}}function c(e){var t;e.done?i(e.value):(t=e.value,t instanceof o?t:new o((function(e){e(t)}))).then(r,l)}c((n=n.apply(e,t||[])).next())}))};Object.defineProperty(t,"__esModule",{value:!0}),t.loadVariablesNotes=void 0;const i=o(998),a=o(437),r=o(945);t.loadVariablesNotes=()=>n(void 0,void 0,void 0,(function*(){const e=yield(0,a.findVariablesNotes)(),t=yield Promise.all(e.map((e=>n(void 0,void 0,void 0,(function*(){return console.info("New note found!"),console.info(JSON.stringify(e)),yield i.default.data.get(["notes",e.id],{fields:["title","body"]})}))))),o={};t.forEach((e=>{if(null!=o[e.title])return;const t=(0,r.parseNote)(e);o[e.title]={vars:t}})),localStorage.setItem("NoteVariables",JSON.stringify(o)),localStorage.setItem("UpdateNoteVariablesMDP","true")}))},945:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.parseNote=void 0;const o=/^\|\s*[^|]*\s*\|\s*[^|]*\s*\|/gm,n=/^\|\s*([^|]*)\s*\|\s*([^|]*)\s*\|/;t.parseNote=e=>{const{body:t}=e,i=t.match(o),a={};if(null==i)return a;for(const e of i.slice(2)){const t=e.match(n);if(""===t[1])continue;const o=t[1].trimEnd(),i=t[2].trimEnd();null==a[o]&&(a[o]=i)}return a}}},t={};!function o(n){var i=t[n];if(void 0!==i)return i.exports;var a=t[n]={exports:{}};return e[n].call(a.exports,a,a.exports,o),a.exports}(156)})();